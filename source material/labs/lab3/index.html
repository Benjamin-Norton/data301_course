<html>
<head>
<title>DATA 301 - Lab 3</title>
<link href="../assign.css" type=text/css rel=stylesheet>
</head>

<body>

<h1>DATA 301 - Introduction to Data Analytics
<br/>Lab 3: Excel - Macros and VBA Scripting</h1>

<hr>

<p>In this lab, we will create macros and user-defined functions to automate tasks and expand the capabilities of Microsoft Excel.</p>

<h3>Objectives</h3>

<ol>
<li>Create a macro using the macro recorder.</li>
<li>Execute a recorded macro to automate a repetitive task.</li>
<li>Create a user-defined function in VBA using the Visual Basic Editor.</li>
<li>Use a user-defined function in a formula.</li>
<li>Add a button (user interface component) to a spreadsheet.</li>
<li>Have a button respond to a click event to run a macro.</li>
</ol>

<h3>Analysis Problem and Goals</h3>

<p>This scenario involves automating a repetitive analysis.  Sales data is being given to the data analyst every day in text form.  The boss wants a specific format of the data in Excel including charts.  Although this only takes less than 10 minutes each day, the same tasks are done every day.  Using macros, we will see a better way.</p>

<p>For this lab, a starter Excel file has been created: <a href="lab3.xlsm">starter Lab 3 Excel File</a>.  There are also text files of sales data for each day of the week: <a href="monday_sales.txt">monday_sales.txt</a>, <a href="tuesday_sales.txt">tuesday_sales.txt</a>, <a href="wednesday_sales.txt">wednesday_sales.txt</a>, <a href="thursday_sales.txt">thursday_sales.txt</a>, and <a href="friday_sales.txt">friday_sales.txt</a>.</p>


<h3>Marking and Evaluation</h3>

<p>Marks are awarded by <em>precisely</em> following these requirements:

<ul>
<li><strong>Record a Simple Macro (1 mark) - </strong>record a macro called <em>BoldGreen</em> with short cut key of <em>Ctrl+Shift+G</em> that will bold, center, and put a green background for the current cell.  Test your macro on any of the cells in the <em>macro</em> sheet.</li>

<li><strong>Record a Complex Macro (4 marks) - </strong>record a macro with name <em>SaveRepetitiveWork</em> that does the following tasks:
	<ul>
		<li>Opens the file <em>sales.txt</em> in the current directory and imports it into Excel.  (0.5 marks)</li>
		<li>Formats the two header fields to be bold and center.  (0.25 marks)</li>
		<li>Uses conditional formatting so sales cells with values &lt; 100 have a red background and greater than 500 have a green background. (0.5 marks)</li>
		<li>Sorts the data in descending order by sales.  (0.25 marks)</li>
		<li>In cell <em>B13</em> creates a sales total.  Make sure all sales show as <em>currency</em> formatted.  (0.25 marks)</li>
		<li>Creates a column called <em>Percentage</em> that computes the percent sales of each item.  (0.25 marks)</li>
		<li>Creates a bar chart with title <em>Product Sales</em>. (0.5 marks)</li>
		<li>Creates a pie chart with title <em>Percentage Sales</em>. (0.5 marks)</li>
		<li>Run your macro five times; once for each day of sales data.  For example, to process <em>monday_sales.txt</em> rename it as <em>sales.txt</em> then run your macro.  Take the resulting new sheet and move it into your <em>lab3.xlsm</em> workbook and rename to <em>monday</em>.  (Note: To move, right-click on sheet name and select <em>Move or Copy</em> then select the <em>lab3</em> workbook.) Repeat for the other 4 days. (1 mark)</li>
		<li><strong>Suggestion:</strong> Try to do these steps first then record using macro recorder.  You can also record some of the tasks individually and copy/paste code to build a larger macro.</li>
	</ul>
</li>

<li><strong>Create and Use a User-Defined Function (2 marks) </strong>- the <em>udf</em> sheet is setup for creating and using a user-defined function.  Steps:
	<ul>
	<li>In the Visual Basic Editor, in <em>module1</em> there is a function already created called <em>SUMCOLOR</em> for you to edit.  This function is similar to one in the notes except that instead of the color being given to sum the cells, the color is retrieved from the color of the cell given in the second argument. (1 mark)</li>
	<li>Use the function <em>SUMCOLOR</em> to create formulas for cells <em>F3:F5</em> that sum the cells that are orange, blue, and green. (1 mark)</li>
	</ul>
</li>

<li><strong>Buttons and Events (2 marks) - </strong>in the sheet called <em>button</em> add a button that when clicked will call a macro called <em>setDate</em> that sets the cell <em>A3</em> to the current date and time in the format shown in the screenshot.  You will need to write the <em>setDate</em> macro.
</li>

<li><strong>Bonus (1 mark) - </strong>add a sheet called <em>bonus</em> and in it describe some additional work that you did such as creating an interesting macro, adding other controls besides a button, or some useful user-defined function you wrote in VBA code.</li>
</ul>

</p>

<p>When complete, submit your Excel file named <strong>lab3_(yourstudentnum).xlsm</strong> (e.g. <strong>lab3_11111111.xlsm</strong>) using Connect.</p>


<h3>Screenshots</h3>

<h4>macro sheet</h4>

<img src="img/lab3_macro.png" width="800">

<h4>udf sheet</h4>

<img src="img/lab3_udf.png" width="800">

<h4>button sheet</h4>

<img src="img/lab3_button.png" width="800">

<h4>monday sheet</h4>

<img src="img/lab3_monday.png" width="800">

<h4>friday sheet</h4>

<img src="img/lab3_friday.png" width="800">


<hr>
<img src="../../../../images/go-upwd.gif" alt="*"  align="top" height="14" width="14">
        <a href="../index.html">Home</a>
<hr>

</body>
</html>
